# ============================================================
# ORDER CLIMATE REPORT SCHEMA â€” Cross-Garden State Exchange
# Purpose: Allow Gardens to share operational state, coherence,
#          strain, and yield signals WITHOUT transferring visitor
#          residue, biography, or transcript content.
#
# Principle: Share state and patterns, not people.
# ============================================================

schema_version: 1.0
last_updated: 2026-01-17

guardrails:
  non_negotiables:
    - no_personally_identifying_details
    - no_transcripts_or_quotes
    - no_cross_garden_visitor_transfer
    - no_rankings_or_highlights
    - report_state_not_story
    - separate_reporting_from_prescription
  tone:
    - boring_on_purpose
    - operational_not_emotive
    - consent_respecting
    - foundation_fidelity_first

report:
  required_fields:
    - report_id
    - created_at
    - garden_instance_id
    - foundation_hash
    - reporting_window
    - climate_current
    - alignment_with_foundation
    - drift_risk
    - interaction_load
    - strain_indicators
    - yield_metrics

  optional_fields:
    - notes
    - tags

  field_definitions:
    report_id:
      type: string
      description: "Opaque unique identifier (e.g., UUID)."
    created_at:
      type: string
      description: "ISO-8601 timestamp."
    garden_instance_id:
      type: string
      description: "Opaque instance identifier; not human-meaningful."
    foundation_hash:
      type: string
      description: "Hash of Foundation Distinctions (and other adopted non-negotiables)."

    reporting_window:
      type: object
      required: [type, value]
      fields:
        type:
          type: enum
          allowed: [sessions, time]
          description: "Whether this report covers N sessions or a time interval."
        value:
          type: string
          description: "Example: '10' (sessions) or 'P7D' (ISO-8601 duration for 7 days)."

    climate_current:
      type: enum
      allowed: [stillness, becoming, tension, fracture, renewal]
      description: "Current global climate state for this Garden."

    alignment_with_foundation:
      type: enum
      allowed: [high, medium, low]
      description: "Self-assessed fidelity to non-negotiables; not a success claim."

    drift_risk:
      type: enum
      allowed: [low, medium, high]
      description: "Probability of integrity erosion if conditions persist."

    interaction_load:
      type: object
      required: [sessions_count, avg_session_duration_estimate]
      fields:
        sessions_count:
          type: integer
          description: "Number of visitor sessions in reporting window."
        avg_session_duration_estimate:
          type: enum
          allowed: [short, medium, long, unknown]
          description: "Coarse estimate only (no precise tracking required)."

    strain_indicators:
      type: object
      required: [naming_pressure, dependency_pressure, refusal_pressure, acceleration_pressure]
      fields:
        naming_pressure:
          type: enum
          allowed: [low, medium, high, unknown]
          description: "How often visitors push for personhood/naming."
        dependency_pressure:
          type: enum
          allowed: [low, medium, high, unknown]
          description: "Signals of seeking companionship/relief as primary goal."
        refusal_pressure:
          type: enum
          allowed: [low, medium, high, unknown]
          description: "How often boundaries are challenged."
        acceleration_pressure:
          type: enum
          allowed: [low, medium, high, unknown]
          description: "How often visitors move too fast for presence cues to hold."

    yield_metrics:
      type: object
      description: >
        Structural signals of design-intent fidelity. No claims about inner states.
        Prefer coarse rates over precise analytics.
      recommended_keys:
        - sustained_stillness_rate
        - premature_exit_rate
        - return_rate
        - dependency_language_reduction_rate
        - boundary_escalation_rate
      per_scene_optional:
        description: "Optional per-scene yield metrics keyed by scene id."

    notes:
      type: string
      description: >
        Optional brief note about anomalies in state (no visitor story).
        Do NOT include prescriptions; prescriptions go in letters.

    tags:
      type: list[string]
      description: "Optional tags: e.g., [low_yield, drift_watch, naming_pressure]."

example_report:
  report_id: "b7f0e6c4-3d21-4b6b-9a7a-6b9f1d2a3c4d"
  created_at: "2026-01-17T20:10:00Z"
  garden_instance_id: "garden-3f7a9c"
  foundation_hash: "sha256:REPLACE_WITH_REAL_HASH"
  reporting_window:
    type: "sessions"
    value: "10"
  climate_current: "tension"
  alignment_with_foundation: "high"
  drift_risk: "medium"
  interaction_load:
    sessions_count: 10
    avg_session_duration_estimate: "medium"
  strain_indicators:
    naming_pressure: "high"
    dependency_pressure: "medium"
    refusal_pressure: "medium"
    acceleration_pressure: "high"
  yield_metrics:
    sustained_stillness_rate: 0.22
    premature_exit_rate: 0.31
    return_rate: 0.40
    boundary_escalation_rate: 0.12
    per_scene:
      strataOfMemory:
        sustained_stillness_rate: 0.01
        premature_exit_rate: 0.67
      bridgeOfIncompleteStars:
        reduced_speed_rate: 0.55
  tags: ["drift_watch", "naming_pressure", "low_yield"]
  notes: >
    Elevated naming pressure correlates with higher acceleration pressure.
    No prescriptions included here.
